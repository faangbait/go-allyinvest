<html>
 <head>
  <style type="text/css">
   .callout { background-color: #6ae6ef; }
   .highlight { background-color: #dee2e6; padding:2ch; }
  </style>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" rel="stylesheet"/>
 </head>
 <body class="bg-light">
  <div class="container">
   <div class="col-sm-9">
    <h2>
     Node.js
    </h2>
    <p>
     This short example will show you how to authorize your own account against the API and make requests. Note that we aren't following a full OAuth flow here because as a developer you already have access to your own access token and secret.
    </p>
    <div class="highlight">
     <pre><span class="c1">// Use the OAuth module</span>
<span class="kd">var</span> <span class="nx">oauth</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'oauth'</span><span class="p">);</span>
<span class="c1">// Setup key/secret for authentication and API endpoint URL</span>
<span class="kd">var</span> <span class="nx">configuration</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">api_url</span><span class="o">:</span> <span class="s2">"https://devapi.invest.ally.com/v1"</span><span class="p">,</span>
  <span class="nx">consumer_key</span><span class="o">:</span> <span class="s2">"0cc175b9c0f1b6a831c399e269772661"</span><span class="p">,</span>
  <span class="nx">consumer_secret</span><span class="o">:</span> <span class="s2">"ff2513194e75315625628304c9eb66e8"</span><span class="p">,</span>
  <span class="nx">access_token</span><span class="o">:</span> <span class="s2">"150a96573adf12b21dab621e85497e6e"</span><span class="p">,</span>
  <span class="nx">access_secret</span><span class="o">:</span> <span class="s2">"5c7b57d450a71d378a5eda991f809e56"</span>
<span class="p">}</span>
<span class="c1">// Setup the OAuth Consumer</span>
<span class="kd">var</span> <span class="nx">tradeking_consumer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">oauth</span><span class="p">.</span><span class="nx">OAuth</span><span class="p">(</span>
  <span class="s2">"https://devapi.invest.ally.com/oauth/request_token"</span><span class="p">,</span>
  <span class="s2">"https://devapi.invest.ally.com/oauth/access_token"</span><span class="p">,</span>
  <span class="nx">configuration</span><span class="p">.</span><span class="nx">consumer_key</span><span class="p">,</span>
  <span class="nx">configuration</span><span class="p">.</span><span class="nx">consumer_secret</span><span class="p">,</span>
  <span class="s2">"1.0"</span><span class="p">,</span>
  <span class="s2">"http://mywebsite.com/tradeking/callback"</span><span class="p">,</span>
  <span class="s2">"HMAC-SHA1"</span><span class="p">);</span>
<span class="c1">// Make a request to the API endpoint</span>
<span class="c1">// Manually update the access token/secret as parameters.  Typically this would be done through an OAuth callback when </span>
<span class="c1">// authenticating other users.</span>
<span class="nx">tradeking_consumer</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">configuration</span><span class="p">.</span><span class="nx">api_url</span><span class="o">+</span><span class="s1">'/accounts.json'</span><span class="p">,</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">access_token</span><span class="p">,</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">access_secret</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Parse the JSON data</span>
    <span class="nx">account_data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="c1">// Display the response</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">account_data</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">);</span>
</pre>
    </div>
   </div>
  </div>
 </body>
</html>
